<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kintsugi Global — Get Involved</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <style>
    :root{
      --bg:#f6f7f9; --text:#0d1117; --muted:#6b7280; --border:#e5e7eb; --brand:#0d1117; --radius:12px;
      --accent:#DF1824; /* matches brand red seen in existing footer icon fills */
    }
    *{box-sizing:border-box}
    body{margin:0; font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";}
    .container{max-width:1100px; margin:0 auto; padding:28px 16px;}
    header.page{padding:28px 0 10px;}
    h1{margin:0 0 8px; font-size:clamp(1.4rem, 2.4vw + .8rem, 2rem);}
    p.lede{color:var(--muted); margin:0;}
    .grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(260px, 1fr)); gap:16px; margin-top:18px;}
    .card{background:#fff; border:1px solid var(--border); border-radius:var(--radius); padding:16px;}
    .card h2{margin:.2rem 0 .2rem; font-size:1.1rem}
    .card p{margin:.35rem 0; color:var(--muted)}
    .cta-row{display:flex; flex-wrap:wrap; gap:10px; margin-top:10px}
    /* Borrowed look from partners.html */
    .btn{
      appearance:none; border:none; cursor:pointer; background:var(--brand); color:#fff;
      padding:10px 14px; border-radius:10px; font-weight:600; font-size:.95rem; text-decoration:none; display:inline-block;
    }
    .btn:hover{opacity:.92}
    .btn.secondary{background:#111827}
    .btn.ghost{background:#fff; color:var(--brand); border:1px solid var(--border)}
    .eyebrow{letter-spacing:.06em; text-transform:uppercase; font-weight:700; color:var(--muted); font-size:.8rem}
    section.block{margin:22px 0}
    /* Forms (lightweight; pairs with .sub-f-btn already used in contact/corporate) */
    form{display:grid; gap:10px; margin-top:10px}
    label{font-weight:600}
    input, textarea{width:100%; padding:10px 12px; border:1px solid var(--border); border-radius:10px; font:inherit}
    textarea{min-height:120px}
    .sub-f-btn{background:var(--accent); color:#fff; border:none; border-radius:10px; padding:10px 14px; font-weight:700; cursor:pointer}
    .sub-f-btn:hover{opacity:.92}
    /* Card accents per audience */
    .tag{display:inline-block; padding:4px 8px; border-radius:999px; background:#fff; border:1px solid var(--border); color:var(--muted); font-size:.8rem}
    footer.page{margin:40px 0 20px; color:var(--muted); font-size:.9rem}
  </style>
</head>
<body>

  <div class="container">
    <header class="page" aria-label="CTA hub header">
      <div class="eyebrow">Get Involved</div>
      <h1>Contact With Us</h1>
      <p class="lede">Quick links and forms to take action right now.</p>
    </header>
    

    <!-- Role-specific sign-up blocks (two cards in a row: Artists & Fans) -->
    <section id="investors" class="block card" aria-labelledby="investors-h">
      <h2 id="investors-h">Request Investor Materials</h2>
      <form onsubmit="return false" aria-label="Investor deck request">
        <label for="in1-name">Title</label>
        <input id="in1-name" name="title" type="text" placeholder="Title" required>
        <label for="in1-name">Name</label>
        <input id="in1-name" name="name" type="text" placeholder="Full name" required>
        <label for="in1-email">Email</label>
        <input id="in1-email" name="email" type="email" placeholder="example@email.com" required>
        <label for="in1-link">Link</label>
        <input id="in1-link" name="link" type="url" placeholder="Website or LinkedIn">
        <button type="submit" class="sub-f-btn">Reach Out</button>
      </form>
    </section>

    <!-- Additional CTAs (#18) -->
    <section id="newsletter" class="block card" aria-labelledby="newsletter-h">
      <h2 id="newsletter-h">Newsletter Signup</h2>
      <p class="lede">Get early artist drops from your loving artists.</p>
      <form onsubmit="return false" aria-label="Newsletter sign up">
        <label for="nl-name">Name</label>
        <input id="nl-name" name="name" type="text" placeholder="Full name" required>
        <label for="nl-email">Email</label>
        <input id="nl-email" name="email" type="email" placeholder="example@email.com" required aria-required="true" />
        <button type="submit" class="sub-f-btn">Subscribe</button>
      </form>
    </section>

    <section id="early-access" class="block card" aria-labelledby="early-h">
      <h2 id="early-h">Early Access Registration</h2>
      <p class="lede">Be among the first to try new creator & fan features.</p>
      <form onsubmit="return false" aria-label="Early access registration">
        <label for="ea-name">Name</label>
        <input id="ea-name" name="name" type="text" placeholder="Full name" required aria-required="true" />
        <label for="ea-email">Email</label>
        <input id="ea-email" name="email" type="email" placeholder="you@example.com" required aria-required="true" />
        <button type="submit" class="sub-f-btn">Request Access</button>
      </form>
    </section>

    <!-- Direct Contact Scheduling (uses Calendly inline embed) -->
    <section id="schedule" class="block card" aria-labelledby="sched-h">
      <h2 id="sched-h">Schedule a Call</h2>
      <p class="lede">Pick a time that works — no back-and-forth.</p>
      <div class="calendly-inline-widget"
         data-url="https://calendly.com/ron-kintsugi"
         style="min-width:200px;max-width:100%;height:500px;"></div>
      <script src="https://assets.calendly.com/assets/external/widget.js" async></script>
    </section>

    <!-- Lightweight investor anchor so the Investor CTA has a real target -->
    <section id="investors-info" class="block card" aria-labelledby="invest-info-h">
      <h2 id="invest-info-h">Investor Information</h2>
      <p>For the latest pitch materials, please schedule a call above or email at <a href="mailto:ron@kintsugi.global">ron@kintsugi.global</a>.</p>
    </section>

  </div>

  <!-- Accessibility notes: CTAs that navigate are anchors styled as buttons per WAI guidance. -->
  
  <!-- Submission handler: posts form data to a Google Apps Script endpoint. Replace APPS_SCRIPT_URL with your deployed URL. -->
  <script>
    // TODO: replace this with your deployed Apps Script "exec" URL
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyl59coHBR2DKx3Xq49izLZ-hLBw7quY22cikAOma3M1vXPzmkAE4oWp3XZfBSNVxE/exec';

    function showMessage(form, text, isError) {
      let region = form.querySelector('.form-msg');
      if (!region) {
        region = document.createElement('div');
        region.className = 'form-msg';
        region.setAttribute('role', 'status');
        region.style.marginTop = '8px';
        region.style.fontSize = '0.95rem';
        form.appendChild(region);
      }
      region.textContent = text;
      region.style.color = isError ? '#9b2c2c' : '#166534';
    }

    async function postToEndpoint(payload) {
      if (!APPS_SCRIPT_URL || APPS_SCRIPT_URL.indexOf('REPLACE_WITH') === 0) {
        throw new Error('Apps Script URL not configured. Replace APPS_SCRIPT_URL in ctas.html with your deploy URL.');
      }

      // Try JSON fetch first (clean UX). If that fails (CORS/preflight), fall back to a plain form POST
      try {
        const res = await fetch(APPS_SCRIPT_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload),
          mode: 'cors'
        });

        // If the response is not JSON or not ok, throw to trigger fallback
        const text = await res.text();
        try { return JSON.parse(text); } catch (e) { throw new Error('Non-JSON response'); }
      } catch (err) {
        // fallback: submit a hidden form (avoids preflight/CORS issues)
        try {
          await submitViaForm(payload);
          return { status: 'success', message: 'submitted-via-form-fallback' };
        } catch (err2) {
          throw err2;
        }
      }
    }

    // Create and submit a hidden form targeting an invisible iframe so the page doesn't navigate.
    function submitViaForm(payload){
      return new Promise((resolve, reject) => {
        try {
          // ensure hidden iframe exists
          let iframe = document.getElementById('hidden-form-target');
          if (!iframe) {
            iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.id = 'hidden-form-target';
            iframe.name = 'hidden-form-target';
            document.body.appendChild(iframe);
          }

          const form = document.createElement('form');
          form.method = 'post';
          form.action = APPS_SCRIPT_URL;
          form.target = iframe.name;
          form.style.display = 'none';

          const addField = (name, value) => {
            const i = document.createElement('input');
            i.type = 'hidden';
            i.name = name;
            i.value = value || '';
            form.appendChild(i);
          };

          addField('name', payload.name || '');
          addField('email', payload.email || '');
          if (payload.audience) addField('audience', payload.audience);
          if (payload.link) addField('link', payload.link);
          if (payload.title) addField('title', payload.title);

          document.body.appendChild(form);

          // Submit and resolve shortly after (we can't read the iframe response reliably without CORS)
          form.submit();
          setTimeout(() => {
            try { document.body.removeChild(form); } catch (e) {}
            resolve();
          }, 800);
        } catch (e) {
          reject(e);
        }
      });
    }

    function wireForm(form, opts = {}){
      form.addEventListener('submit', async function(e){
        e.preventDefault();
        const submitBtn = form.querySelector('button[type=submit]');
        const title = (form.querySelector('input[name="title"]') || {}).value || '';
        const name = (form.querySelector('input[name="name"]') || {}).value || '';
        const email = (form.querySelector('input[type="email"]') || {}).value || '';
        const audience = (form.querySelector('input[name="audience"]') || {}).value || opts.audience || '';
        const link = (form.querySelector('input[name="link"]') || {}).value || '';

        if (!email) {
          showMessage(form, 'Please enter a valid email address.', true);
          return;
        }

        try {
          if (submitBtn) { submitBtn.disabled = true; submitBtn.textContent = 'Sending...'; }
          const payload = { name: name.trim(), email: email.trim(), audience };
          if (link) payload.link = link.trim();
          if (title) payload.title = title.trim();
          const json = await postToEndpoint(payload);
          if (json && json.status === 'success') {
            showMessage(form, 'Thanks — we saved your info.', false);
            if (submitBtn) submitBtn.textContent = 'Sent';
          } else {
            const msg = (json && json.message) ? json.message : 'Submission failed';
            showMessage(form, msg, true);
            if (submitBtn) { submitBtn.disabled = false; submitBtn.textContent = 'Try again'; }
          }
        } catch (err) {
          showMessage(form, err.message || 'Network error', true);
          if (submitBtn) { submitBtn.disabled = false; submitBtn.textContent = 'Try again'; }
        }
      });
    }

    document.addEventListener('DOMContentLoaded', function(){
      // Wire the newsletter form
      const newsletter = document.querySelector('#newsletter form');
      if (newsletter) wireForm(newsletter, { audience: 'newsletter' });

      // Wire early access
      const early = document.querySelector('#early-access form');
      if (early) wireForm(early, { audience: 'early-access' });

      // Wire investor deck request (already contains hidden audience/intent fields)
      const investors = document.querySelector('#investors form');
      if (investors) wireForm(investors, { audience: 'investors' });
    });
  </script>
</body>
</html>